<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8" />
  <title>ì˜¤ëŠ˜ì˜ í€´ì¦ˆ - ì‹ ê³ ê´€ë¦¬</title>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = { theme: { extend: { colors: { main: "#A57A62" } } } };
  </script>
</head>

<body class="bg-white text-stone-800">
  
  <header class="w-full bg-white shadow-md p-4 flex justify-center sticky top-0 z-51">
    <div class="flex items-center justify-between w-full max-w-[1000px]">
      <h1><a href="/afterlogin"
        class="text-4xl font-extrabold text-[#a57a62] hover:text-[#8d6c54] transition-colors">
        ì˜¤ëŠ˜ì˜ í€´ì¦ˆ
      </a></h1>
      <div class="flex items-center space-x-4 text-gray-500 font-semibold text-lg">
        <button id="logout-button" class="hover:underline transition-colors">
          ë¡œê·¸ì•„ì›ƒ
        </button>
        <button id="username-button" class="hover:underline transition-colors">
          {{ username }}
        </button>
      </div>
    </div>
  </header>

  <div class="max-w-3xl mx-auto px-4 py-5">
    <div class="flex items-center justify-between">
      <h1 class="text-2xl font-extrabold text-main">ğŸš¨ ì‹ ê³ ëœ ë¬¸ì œ ê´€ë¦¬</h1>
    </div>
    <p class="px-1 text-stone-500 text-sm mt-1">
      ì‹ ê³ ëœ ë¬¸ì œë“¤ì„ í™•ì¸í•˜ê³  ì¡°ì¹˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    </p>
  </div>

  <main class="max-w-3xl mx-auto px-4 pb-16 space-y-6">
    {% for q in quizzes %}
    <div class="bg-white rounded-2xl shadow p-6 space-y-3 border border-stone-200 hover:shadow-md transition"
      data-id="{{ q._id }}">
      <!-- ë¬¸ì œ ì œëª© -->
      <div class="flex items-center justify-between">
        <h2 class="font-semibold text-lg text-stone-800">
          {{ loop.index }}. {{ q.quiz_sentence }} - {{ q.category }}
        </h2>
        <span class="px-3 py-1 text-xs rounded-full bg-red-100 text-red-600 font-medium">ì‹ ê³  {{ q.complaint }}íšŒ</span>
      </div>

      <!-- ì½”ë“œ ì˜ì—­ -->
      <pre class="bg-stone-200 rounded-md p-4 overflow-auto text-sm text-stone-800"><code>{{ q.quiz_code }}</code></pre>

      <!-- ë²„íŠ¼ -->
      <div class="flex gap-3">
        <button onclick="restoreQuiz('{{ q._id }}')"
          class="flex-1 rounded-md bg-white border border-main text-main font-medium px-4 py-2 hover:bg-main/5 transition">
          ë³µêµ¬í•˜ê¸°
        </button>
        <button onclick="deleteQuiz('{{ q._id }}')"
          class="flex-1 rounded-md bg-main text-white font-medium px-4 py-2 hover:brightness-95 transition">
          ì˜êµ¬ ì‚­ì œ
        </button>
      </div>
    </div>
    {% endfor %}
  </main>

  <script>
    document.getElementById("logout-button").addEventListener("click", () => {
      fetch("/logout", { method: "POST" })
        .then((res) => res.json())
        .then(() => { window.location.href = "/"; });
    });

    document.getElementById("username-button").addEventListener("click", () => {
      window.location.href = "/mypage";
    });
    function deleteQuiz(id) {
      if (!confirm("ì •ë§ë¡œ ì´ ë¬¸ì œë¥¼ ì˜êµ¬ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) return;
      $.post(`/quiz/delete/${id}`, {}, function (res) {
        alert(res.msg);
        $(`[data-id='${id}']`).remove();
      });
    }

    function restoreQuiz(id) {
      $.post(`/quiz/restore/${id}`, {}, function (res) {
        alert(res.msg);
        $(`[data-id='${id}']`).remove();
      });
    }
  </script>
</body>

</html>